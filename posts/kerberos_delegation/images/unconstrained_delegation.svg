<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="573px" preserveAspectRatio="none" style="width:715px;height:573px;background:#FFFFFF;" version="1.1" viewBox="0 0 715 573" width="715px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="105" x2="105" y1="36.2969" y2="537.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="262" x2="262" y1="36.2969" y2="537.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="515" x2="515" y1="36.2969" y2="537.9531"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="668" x2="668" y1="36.2969" y2="537.9531"/><rect fill="#F4A460" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45" x="83" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="90" y="24.9951">User</text><rect fill="#F4A460" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45" x="83" y="536.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="90" y="556.9482">User</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45" x="240" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="247" y="24.9951">KDC</text><rect fill="#90EE90" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45" x="240" y="536.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="247" y="556.9482">KDC</text><rect fill="#ADD8E6" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="475" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="482" y="24.9951">Service A</text><rect fill="#ADD8E6" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="475" y="536.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="482" y="556.9482">Service A</text><rect fill="#87CEFA" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="628" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="635" y="24.9951">Service B</text><rect fill="#87CEFA" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="628" y="536.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="635" y="556.9482">Service B</text><polygon fill="#181818" points="250.5,63.4297,260.5,67.4297,250.5,71.4297,254.5,67.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105.5" x2="256.5" y1="67.4297" y2="67.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="112.5" y="62.3638">AS REQ</text><polygon fill="#181818" points="116.5,92.5625,106.5,96.5625,116.5,100.5625,112.5,96.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="110.5" x2="261.5" y1="96.5625" y2="96.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="122.5" y="91.4966">AS REP</text><polygon fill="#181818" points="250.5,121.6953,260.5,125.6953,250.5,129.6953,254.5,125.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105.5" x2="256.5" y1="125.6953" y2="125.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="112.5" y="120.6294">TGS REQ к Service A</text><line style="stroke:#181818;stroke-width:1.0;" x1="262.5" x2="304.5" y1="215.3594" y2="215.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="304.5" x2="304.5" y1="215.3594" y2="228.3594"/><line style="stroke:#181818;stroke-width:1.0;" x1="263.5" x2="304.5" y1="228.3594" y2="228.3594"/><polygon fill="#181818" points="273.5,224.3594,263.5,228.3594,273.5,232.3594,269.5,228.3594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="269.5" y="149.7622">Service A обладает привилегией</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="269.5" y="164.895">TrustedForDelegation?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="269.5" y="180.0278"> </text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="269.5" y="195.1606">Если да, то добаляет TGT для User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="269.5" y="210.2935">в TGS для Service A</text><polygon fill="#181818" points="116.5,253.4922,106.5,257.4922,116.5,261.4922,112.5,257.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="110.5" x2="261.5" y1="257.4922" y2="257.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="122.5" y="252.4263">TGS REP</text><path d="M5,270.4922 L5,310.4922 L207,310.4922 L207,280.4922 L197,270.4922 L5,270.4922 " fill="#F5F5F5" style="stroke:#181818;stroke-width:0.5;"/><path d="M197,270.4922 L197,280.4922 L207,280.4922 L197,270.4922 " fill="#F5F5F5" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="11" y="287.5591">TGS билет к Service A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="11" y="302.6919">содержащий TGT для User</text><polygon fill="#181818" points="503.5,332.8906,513.5,336.8906,503.5,340.8906,507.5,336.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105.5" x2="509.5" y1="336.8906" y2="336.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="112.5" y="331.8247">AP REQ c с полученным TGS</text><path d="M460,349.8906 L460,374.8906 L570,374.8906 L570,359.8906 L560,349.8906 L460,349.8906 " fill="#F5F5F5" style="stroke:#181818;stroke-width:0.5;"/><path d="M560,349.8906 L560,359.8906 L570,359.8906 L560,349.8906 " fill="#F5F5F5" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="466" y="366.9575">TGT для User</text><polygon fill="#181818" points="273.5,412.2891,263.5,416.2891,273.5,420.2891,269.5,416.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="267.5" x2="514.5" y1="416.2891" y2="416.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="279.5" y="396.0903">TGS REQ к Service B</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="279.5" y="411.2231">c TGT для User</text><polygon fill="#181818" points="503.5,456.5547,513.5,460.5547,503.5,464.5547,507.5,460.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="262.5" x2="509.5" y1="460.5547" y2="460.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="269.5" y="440.356">TGS REP c TGS-билетом</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="269.5" y="455.4888">для User к Service B</text><polygon fill="#181818" points="656.5,515.9531,666.5,519.9531,656.5,523.9531,660.5,519.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="515.5" x2="662.5" y1="519.9531" y2="519.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="522.5" y="484.6216">Олицетворяет User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="522.5" y="499.7544">при помощи</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="522.5" y="514.8872">полученного TGS</text><!--MD5=[b09e980e4150e9e51043ab6e16300624]
@startuml
participant User order 10 #sandybrown
participant KDC order 20 #lightgreen
participant "Service A" order 30 #lightblue
participant "Service B" order 40 #lightskyblue

skinparam sequenceMessageAlign left

User->KDC: AS REQ 
KDC->User: AS REP 
User->KDC: TGS REQ к Service A

KDC->KDC: Service A обладает привилегией\nTrustedForDelegation?\n\nЕсли да, то добаляет TGT для User\nв TGS для Service A

KDC->User: TGS REP 

note over User #whitesmoke 
TGS билет к Service A,
содержащий TGT для User
end note

User->"Service A": AP REQ c с полученным TGS

note over "Service A" #whitesmoke 
TGT для User
end note

"Service A"->"KDC": TGS REQ к Service B\nc TGT для User 
KDC->"Service A": TGS REP c TGS-билетом\nдля User к Service B 

"Service A"->"Service B": Олицетворяет User\nпри помощи\nполученного TGS
@enduml

PlantUML version 1.2022.7beta11(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>